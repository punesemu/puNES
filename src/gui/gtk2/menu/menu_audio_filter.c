/*
 * menu_audio_filter.c
 *
 *  Created on: 11/lug/2012
 *      Author: fhorse
 */

#include "menu_audio_filter.h"
#include "param.h"
#include "cfgfile.h"
#include "audio_filter.h"

#ifdef __SUNPRO_C
#pragma align 4 (icon_inline)
#endif
#ifdef __GNUC__
static const guint8 icon_inline[] __attribute__ ((__aligned__ (4))) =
#else
static const guint8 icon_inline[] =
#endif
{ ""
  /* Pixbuf magic (0x47646b50) */
  "GdkP"
  /* length: header (24) + pixel_data (1273) */
  "\0\0\5\21"
  /* pixdata_type (0x2010002) */
  "\2\1\0\2"
  /* rowstride (96) */
  "\0\0\0`"
  /* width (24) */
  "\0\0\0\30"
  /* height (24) */
  "\0\0\0\30"
  /* pixel_data: */
  "\231\0\0\0\0\1\0\0\0\1\203\0\0\0\2\214\0\0\0\3\202\0\0\0\2\1\0\0\0\1"
  "\204\0\0\0\0\1\0\0\0\1\221\0\0\0\377\3\0\0\0\17\0\0\0\6\0\0\0\1\203\0"
  "\0\0\0\2\0\0\0\2\0\0\0\377\216\377\377\377\377\5\324\324\324\377\0\0"
  "\0\377\0\0\0)\0\0\0\20\0\0\0\2\203\0\0\0\0\25\0\0\0\2\0\0\0\377\320\320"
  "\320\377\343\343\343\377\355\355\355\377\366\366\366\377\377\377\377"
  "\377\366\366\366\377\352\352\352\377\332\332\332\377\315\315\315\377"
  "\305\305\305\377\304\304\304\377\271\271\271\377\255\255\255\377\247"
  "\247\247\377\211\211\211\377\0\0\0\377\0\0\0""6\0\0\0\24\0\0\0\3\203"
  "\0\0\0\0\6\0\0\0\2\0\0\0""9\0\0\0\377\325\325\325\377\350\350\350\377"
  "\361\361\361\377\202\372\372\372\377\15\355\355\355\377\335\335\335\377"
  "\320\320\320\377\310\310\310\377\275\275\275\377\261\261\261\377\252"
  "\252\252\377\212\212\212\377\0\0\0\377\0\0\0e\0\0\0""0\0\0\0\21\0\0\0"
  "\2\203\0\0\0\0\25\0\0\0\1\0\0\0\11\0\0\0C\0\0\0\377\331\331\331\377\355"
  "\355\355\377\366\366\366\377\376\376\376\377\357\357\357\377\335\335"
  "\335\377\320\320\320\377\306\306\306\377\266\266\266\377\253\253\253"
  "\377\212\212\212\377\0\0\0\377\0\0\0f\0\0\0""7\0\0\0\36\0\0\0\11\0\0"
  "\0\1\204\0\0\0\0\23\0\0\0\2\0\0\0\13\0\0\0E\0\0\0\377\335\335\335\377"
  "\361\361\361\377\367\367\367\377\355\355\355\377\331\331\331\377\320"
  "\320\320\377\303\303\303\377\262\262\262\377\213\213\213\377\0\0\0\377"
  "\0\0\0f\0\0\0""7\0\0\0\37\0\0\0\14\0\0\0\2\206\0\0\0\0\21\0\0\0\2\0\0"
  "\0\14\0\0\0E\0\0\0\377\342\342\342\377\362\362\362\377\360\360\360\377"
  "\331\331\331\377\313\313\313\377\276\276\276\377\223\223\223\377\0\0"
  "\0\377\0\0\0f\0\0\0""7\0\0\0\37\0\0\0\14\0\0\0\3\210\0\0\0\0\17\0\0\0"
  "\2\0\0\0\14\0\0\0E\0\0\0\377\344\344\344\377\360\360\360\377\334\334"
  "\334\377\311\311\311\377\235\235\235\377\0\0\0\377\0\0\0f\0\0\0""7\0"
  "\0\0\37\0\0\0\14\0\0\0\3\212\0\0\0\0\15\0\0\0\2\0\0\0\14\0\0\0E\0\0\0"
  "\377\344\344\344\377\341\341\341\377\247\247\247\377\0\0\0\377\0\0\0"
  "f\0\0\0""7\0\0\0\37\0\0\0\14\0\0\0\3\214\0\0\0\0\13\0\0\0\2\0\0\0\14"
  "\0\0\0E\0\0\0\377\331\331\331\377\0\0\0\377\0\0\0g\0\0\0""7\0\0\0\37"
  "\0\0\0\14\0\0\0\3\216\0\0\0\0\15\0\0\0\2\0\0\0\14\0\0\0\377\324\324\324"
  "\377\0\0\0\377\0\0\0@\0\0\0$\0\0\0\14\0\0\0\3\0\0\0\0\0\0\0Z\0\0\0\377"
  "\0\0\0f\214\0\0\0\0\15\0\0\0\5\0\0\0\377\323\323\323\377\0\0\0\377\0"
  "\0\0;\0\0\0\31\0\0\0\5\0\0\0\0\0\0\0\4\0\0\0\377\270\263\233\377\0\0"
  "\0\377\0\0\0\12\213\0\0\0\0\15\0\0\0\3\0\0\0\377\322\322\322\377\0\0"
  "\0\377\0\0\0""9\0\0\0\26\0\0\0\3\0\0\0\0\0\0\0""2\0\0\0\377\353\350\323"
  "\377\0\0\0\377\0\0\0e\213\0\0\0\0\10\0\0\0\3\0\0\0\377\254\254\254\377"
  "\0\0\0\377\0\0\0""9\0\0\0\26\0\0\0\6\0\0\0z\202\0\0\0\377\1\376\376\355"
  "\377\202\0\0\0\377\2\0\0\0{\0\0\0\10\211\0\0\0\0\1\0\0\0\2\203\0\0\0"
  "\377\2\0\0\0""7\0\0\0h\202\0\0\0\377\5g^F\377\364\347\302\377\376\374"
  "\350\377\242~6\377dT5\377\202\0\0\0\377\1\0\0\0@\210\0\0\0\0\21\0\0\0"
  "\2\0\0\0\17\0\0\0)\0\0\0""5\0\0\0)\0\0\0\377\232\205X\377\307\257z\377"
  "\331\302\213\377\337\312\226\377\363\345\276\377\314\261v\377\341\314"
  "\231\377\336\305\215\377\237\213_\377\0\0\0\377\0\0\0""0\207\0\0\0\0"
  "\6\0\0\0\1\0\0\0\6\0\0\0\17\0\0\0\24\0\0\0\17\0\0\0j\202\0\0\0\377\5"
  "D-\16\377}Z\"\377\272\240i\377\210`\37\377^D\27\377\202\0\0\0\377\1\0"
  "\0\0`\211\0\0\0\0\1\0\0\0\1\203\0\0\0\2\3\0\0\0\1\0\0\0\13\0\0\0e\202"
  "\0\0\0\377\1\326\300\216\377\202\0\0\0\377\2\0\0\0\247\0\0\0\20\221\0"
  "\0\0\0\6\0\0\0M\0\0\0\377\330\302\221\377\0\0\0\377\0\0\0\210\0\0\0\4"
  "\222\0\0\0\0\5\0\0\0\10\0\0\0\377\240\220i\377\0\0\0\307\0\0\0\20\224"
  "\0\0\0\0\3\0\0\0q\0\0\0\377\0\0\0\211\226\0\0\0\0\1\0\0\0""0\206\0\0"
  "\0\0"};

enum {
	MAFNONE,
	MAFSIMPLE,
	NUMCHKS
};

void set_audio_filter(int newfilter);

static GtkWidget *check[NUMCHKS];

void menu_audio_filter(GtkWidget *audio, GtkAccelGroup *accel_group) {
	GtkWidget *menu, *filter;

	menu = gtk_menu_new();
	filter = gtk_image_menu_item_new_with_mnemonic("_Filter");

	gtk_menu_item_set_submenu(GTK_MENU_ITEM(filter), menu);
	gtk_menu_shell_append(GTK_MENU_SHELL(audio), filter);

	icon_inline(filter, icon_inline)

	check[MAFNONE] = gtk_check_menu_item_new_with_mnemonic("_None");
	check[MAFSIMPLE] = gtk_check_menu_item_new_with_mnemonic("_Simple");

	gtk_menu_shell_append(GTK_MENU_SHELL(menu), check[MAFNONE]);
	gtk_menu_shell_append(GTK_MENU_SHELL(menu), check[MAFSIMPLE]);

	g_signal_connect_swapped(G_OBJECT(check[MAFNONE]), "activate", G_CALLBACK(set_audio_filter),
	        GINT_TO_POINTER(AF_NONE));
	g_signal_connect_swapped(G_OBJECT(check[MAFSIMPLE]), "activate", G_CALLBACK(set_audio_filter),
	        GINT_TO_POINTER(AF_SIMPLE));
}
void menu_audio_filter_check(void) {
	int index;

	for (index = MAFNONE; index < NUMCHKS; index++) {
		if (cfg->audio_filter == index) {
			gtk_check_menu_item_set_active(GTK_CHECK_MENU_ITEM(check[index]), TRUE);
		} else {
			gtk_check_menu_item_set_active(GTK_CHECK_MENU_ITEM(check[index]), FALSE);
		}
	}
}
void set_audio_filter(int newfilter) {
	if (guiupdate) {
		return;
	}

	if (cfg->audio_filter == newfilter) {
		guiUpdate();
		return;
	}

	emuPause(TRUE);

	cfg->audio_filter = newfilter;

	audio_filter();

	guiUpdate();

	emuPause(FALSE);
}
